<!DOCTYPE html>
<html lang="zh-CN" data-theme="dark">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="墨记 - 优雅的日志管理系统">
  <title>墨记 · 优雅的日志管理系统</title>

  <!-- Preload critical resources -->
  <link rel="preload" href="https://cdn.quilljs.com/1.3.6/quill.snow.css" as="style">
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
  <link rel="preload" href="css/style.css" as="style">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- CSS -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <link href="css/style.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">

  <!-- Favicon -->
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
</head>

<body>
  <div class="app-container">
    <header class="app-header">
      <div class="header-content">
        <h1><i class="fas fa-feather-pointed" aria-hidden="true"></i> 墨记</h1>
        <p class="subtitle">记录思考的闪光，留住生活的点滴</p>
      </div>
      <div class="user-actions">
        <button id="themeToggle" class="btn icon" aria-label="切换主题" data-tooltip="切换主题">
          <i class="fas fa-moon"></i>
        </button>
        <button id="statsButton" class="btn icon" aria-label="查看统计" data-tooltip="数据统计">
          <i class="fas fa-chart-line"></i>
        </button>
        <button id="showSettings" class="btn icon" aria-label="设置" data-tooltip="设置">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </header>

    <main class="app-main">
      <section class="editor-section card frosted">
        <div class="section-header">
          <h2><i class="fas fa-pen-fancy"></i> 撰写日志</h2>
          <div class="editor-tools">
            <button id="editorFullscreen" class="btn icon" aria-label="全屏编辑" data-tooltip="全屏编辑">
              <i class="fas fa-expand-alt"></i>
            </button>
            <button id="quickTemplate" class="btn icon" aria-label="快速模板" data-tooltip="使用模板">
              <i class="fas fa-magic"></i>
            </button>
          </div>
        </div>
        <div id="editor-container" aria-label="日志编辑器"></div>

        <div class="editor-footer">
          <div class="word-count">
            <i class="fas fa-font"></i> <span id="wordCount">0</span> 字
          </div>
          <div class="mood-selector">
            <span class="mood-label">心情:</span>
            <div class="mood-options">
              <button class="mood-btn" data-mood="happy" data-tooltip="开心"><i class="fas fa-smile"></i></button>
              <button class="mood-btn" data-mood="sad" data-tooltip="伤心"><i class="fas fa-frown"></i></button>
              <button class="mood-btn" data-mood="meh" data-tooltip="一般"><i class="fas fa-meh"></i></button>
              <button class="mood-btn" data-mood="angry" data-tooltip="生气"><i class="fas fa-angry"></i></button>
              <button class="mood-btn" data-mood="excited" data-tooltip="兴奋"><i class="fas fa-grin-stars"></i></button>
            </div>
          </div>
          <div class="editor-actions">
            <button id="resetLog" class="btn outline" aria-label="重置">
              <i class="fas fa-redo-alt" aria-hidden="true"></i> 重置
            </button>
            <button id="saveLog" class="btn accent">
              <i class="fas fa-save" aria-hidden="true"></i> 保存日志
            </button>
          </div>
        </div>
      </section>

      <section class="image-upload-section card">
        <div class="section-header">
          <h2><i class="fas fa-images" aria-hidden="true"></i> 图片附件</h2>
          <div class="section-actions">
            <button id="pasteFromClipboard" class="btn outline btn-sm" aria-label="从剪贴板粘贴" data-tooltip="从剪贴板粘贴">
              <i class="fas fa-clipboard"></i> 粘贴
            </button>
            <button id="captureScreen" class="btn outline btn-sm" aria-label="截图" data-tooltip="屏幕截图">
              <i class="fas fa-camera"></i> 截图
            </button>
          </div>
        </div>
        <div class="upload-area" id="dropZone" role="region" aria-labelledby="dropZoneLabel">
          <div class="upload-prompt">
            <i class="fas fa-cloud-upload-alt" aria-hidden="true"></i>
            <p id="dropZoneLabel">拖放图片到这里或点击选择文件</p>
            <small>支持JPG、PNG、GIF等格式（最大5MB）</small>
          </div>
          <input type="file" id="image-upload" accept="image/*" multiple class="image-input"
            aria-labelledby="dropZoneLabel" />
        </div>
        <div id="image-preview-container" class="image-grid"></div>
        <div class="upload-controls">
          <button id="arrangeImages" class="btn outline btn-sm" aria-label="排序图片" data-tooltip="排序图片">
            <i class="fas fa-sort"></i> 排序
          </button>
          <button id="optimize-images" class="btn outline btn-sm" aria-label="优化图片" data-tooltip="优化图片质量">
            <i class="fas fa-compress-arrows-alt"></i> 优化
          </button>
          <button id="clear-images" class="btn outline btn-sm danger">
            <i class="fas fa-trash-alt" aria-hidden="true"></i> 清空图片
          </button>
        </div>
      </section>

      <section class="logs-section">
        <div class="card frosted">
          <div class="section-header">
            <h2><i class="fas fa-history" aria-hidden="true"></i> 历史记录</h2>
            <div class="section-actions">
              <button id="viewMode" class="btn icon" aria-label="切换视图模式" data-tooltip="切换视图">
                <i class="fas fa-th-list"></i>
              </button>
              <div class="btn-group">
                <button id="exportLogs" class="btn outline btn-sm">
                  <i class="fas fa-download" aria-hidden="true"></i> 导出
                </button>
                <button id="importLogs" class="btn outline btn-sm">
                  <i class="fas fa-upload" aria-hidden="true"></i> 导入
                </button>
              </div>
              <button id="clearAllLogs" class="btn danger btn-sm">
                <i class="fas fa-broom" aria-hidden="true"></i> 清空
              </button>
            </div>
          </div>

          <div class="log-filters">
            <div class="search-box">
              <input type="text" id="searchInput" placeholder="搜索日志..." aria-label="搜索日志">
              <i class="fas fa-search" aria-hidden="true"></i>
            </div>
            <div class="filter-controls">
              <div class="date-filter">
                <input type="date" id="dateFilter" aria-label="按日期筛选">
                <i class="fas fa-calendar-alt" aria-hidden="true"></i>
              </div>
              <button id="clearFilters" class="btn outline btn-sm">
                <i class="fas fa-times"></i> 清除筛选
              </button>
            </div>
          </div>

          <div id="logList" class="log-list"></div>
          
          <div class="pagination">
            <button id="prevPage" class="btn outline btn-sm"><i class="fas fa-chevron-left"></i> 上一页</button>
            <span id="pageIndicator">第 <span id="currentPage">1</span>/<span id="totalPages">1</span> 页</span>
            <button id="nextPage" class="btn outline btn-sm">下一页 <i class="fas fa-chevron-right"></i></button>
          </div>
        </div>
        
        <!-- 删除快览卡片 -->
      </section>
    </main>

    <footer class="app-footer">
      <div class="storage-info">
        <div class="storage-text">
          <span id="storageInfo">存储空间: 0.2MB / 5MB</span>
        </div>
        <div class="storage-bar">
          <div class="storage-used" id="storageUsed" style="width: 4%;"></div>
        </div>
      </div>
      <div class="footer-links">
        <a href="#" id="showShortcuts"><i class="fas fa-keyboard" aria-hidden="true"></i> 快捷键</a>
        <a href="#" id="showBackup"><i class="fas fa-cloud-upload-alt" aria-hidden="true"></i> 云备份</a>
        <a href="#" id="showSettings"><i class="fas fa-cog" aria-hidden="true"></i> 设置</a>
        <a href="https://github.com/ucyuunaka/Log-d" target="_blank"><i class="fab fa-github" aria-hidden="true"></i> 源码</a>
      </div>
    </footer>
  </div>

  <!-- 模态框组件 -->
  
  <!-- 模板选择模态框 -->
  <div id="templatesModal" class="modal">
    <div class="modal-content card">
      <h3><i class="fas fa-magic"></i> 快速模板</h3>
      <div class="template-list">
        <button class="template-item" data-template="daily">
          <i class="fas fa-calendar-day"></i>
          <span>每日记录</span>
          <small>记录今天的重要事项和感受</small>
        </button>
        <button class="template-item" data-template="gratitude">
          <i class="fas fa-pray"></i>
          <span>感恩记录</span>
          <small>记录生活中值得感恩的事物</small>
        </button>
        <button class="template-item" data-template="idea">
          <i class="fas fa-lightbulb"></i>
          <span>创意灵感</span>
          <small>记录突发奇想的创意和想法</small>
        </button>
        <button class="template-item" data-template="travel">
          <i class="fas fa-plane"></i>
          <span>旅行笔记</span>
          <small>记录旅途中的见闻和感受</small>
        </button>
      </div>
      <div class="modal-actions">
        <button id="templateClose" class="btn outline">关闭</button>
      </div>
    </div>
  </div>

  <!-- 设置模态框 -->
  <div id="settingsModal" class="modal">
    <div class="modal-content card">
      <h3><i class="fas fa-cog"></i> 设置</h3>
      <div class="settings-form">
        <div class="setting-group">
          <h4>外观</h4>
          <div class="setting-item">
            <label for="themeSetting">
              <i class="fas fa-palette"></i> 界面主题
            </label>
            <select id="themeSetting">
              <option value="dark">深空主题</option>
              <option value="light">清新亮色</option>
              <option value="auto">跟随系统</option>
            </select>
          </div>
          <div class="setting-item">
            <label for="fontSizeSetting">
              <i class="fas fa-text-height"></i> 字体大小
            </label>
            <select id="fontSizeSetting">
              <option value="small">小</option>
              <option value="medium" selected>中</option>
              <option value="large">大</option>
            </select>
          </div>
        </div>
        
        <div class="setting-group">
          <h4>编辑器</h4>
          <div class="setting-item toggle">
            <label for="autoSaveSetting">
              <i class="fas fa-save"></i> 自动保存草稿
            </label>
            <label class="switch">
              <input type="checkbox" id="autoSaveSetting">
              <span class="slider round"></span>
            </label>
          </div>
          <div class="setting-item toggle">
            <label for="spellcheckSetting">
              <i class="fas fa-spell-check"></i> 拼写检查
            </label>
            <label class="switch">
              <input type="checkbox" id="spellcheckSetting" checked>
              <span class="slider round"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-group">
          <h4>数据</h4>
          <div class="setting-item toggle">
            <label for="compressImagesSetting">
              <i class="fas fa-compress"></i> 自动压缩图片
            </label>
            <label class="switch">
              <input type="checkbox" id="compressImagesSetting" checked>
              <span class="slider round"></span>
            </label>
          </div>
          <div class="setting-item toggle">
            <label for="localBackupSetting">
              <i class="fas fa-history"></i> 本地备份
            </label>
            <label class="switch">
              <input type="checkbox" id="localBackupSetting">
              <span class="slider round"></span>
            </label>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="settingsCancel" class="btn outline">取消</button>
        <button id="settingsSave" class="btn accent">保存设置</button>
      </div>
    </div>
  </div>

  <!-- 快捷键模态框 -->
  <div id="shortcutsModal" class="modal">
    <div class="modal-content card">
      <h3><i class="fas fa-keyboard"></i> 键盘快捷键</h3>
      <div class="shortcuts-list">
        <div class="shortcut-item">
          <span class="key-combo"><kbd>Ctrl</kbd> + <kbd>S</kbd></span>
          <span class="key-desc">保存日志</span>
        </div>
        <div class="shortcut-item">
          <span class="key-combo"><kbd>Ctrl</kbd> + <kbd>N</kbd></span>
          <span class="key-desc">新建日志</span>
        </div>
        <div class="shortcut-item">
          <span class="key-combo"><kbd>Ctrl</kbd> + <kbd>F</kbd></span>
          <span class="key-desc">搜索日志</span>
        </div>
        <div class="shortcut-item">
          <span class="key-combo"><kbd>Ctrl</kbd> + <kbd>I</kbd></span>
          <span class="key-desc">插入图片</span>
        </div>
        <div class="shortcut-item">
          <span class="key-combo"><kbd>F11</kbd></span>
          <span class="key-desc">全屏编辑</span>
        </div>
        <div class="shortcut-item">
          <span class="key-combo"><kbd>Esc</kbd></span>
          <span class="key-desc">关闭弹窗</span>
        </div>
      </div>
      <div class="modal-actions">
        <button id="shortcutsClose" class="btn outline">关闭</button>
      </div>
    </div>
  </div>

  <!-- 统计详情模态框 -->
  <div id="statsModal" class="modal">
    <div class="modal-content card">
      <h3><i class="fas fa-chart-pie"></i> 日志统计</h3>
      <div class="tabs">
        <button class="tab-btn active" data-tab="overview">概览</button>
        <button class="tab-btn" data-tab="trends">趋势</button>
        <button class="tab-btn" data-tab="insights">分析</button>
      </div>
      <div class="tab-content active" data-tab-content="overview">
        <div class="stats-container">
          <div class="stat-item">
            <div class="stat-value" id="statTotalLogs">0</div>
            <div class="stat-label">总日志数</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="statAvgWords">0</div>
            <div class="stat-label">平均字数</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="statImagesCount">0</div>
            <div class="stat-label">总图片数</div>
          </div>
          <div class="stat-item">
            <div class="stat-value" id="statActiveDay">周一</div>
            <div class="stat-label">最活跃日</div>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="activityChart"></canvas>
          <p class="chart-label">最近30天活动</p>
        </div>
      </div>
      <div class="tab-content" data-tab-content="trends">
        <div class="chart-container">
          <canvas id="trendsChart"></canvas>
          <p class="chart-label">月度活动趋势</p>
        </div>
        <div class="trend-summary">
          <h4>活跃时段</h4>
          <div class="time-blocks">
            <div class="time-block" style="height: 30%;" data-tooltip="早晨: 18%"></div>
            <div class="time-block" style="height: 20%;" data-tooltip="上午: 12%"></div>
            <div class="time-block" style="height: 45%;" data-tooltip="下午: 27%"></div>
            <div class="time-block" style="height: 70%;" data-tooltip="晚上: 43%"></div>
          </div>
          <div class="time-labels">
            <span>早晨</span>
            <span>上午</span>
            <span>下午</span>
            <span>晚上</span>
          </div>
        </div>
      </div>
      <div class="tab-content" data-tab-content="insights">
        <div class="mood-analysis">
          <h4>情绪分析</h4>
          <div class="mood-chart">
            <canvas id="moodChart"></canvas>
          </div>
        </div>
        <div class="word-cloud-container">
          <h4>常用词云</h4>
          <div class="word-cloud" id="wordCloud">
            <!-- 词云将由JS动态生成 -->
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="statsExport" class="btn outline">导出数据</button>
        <button id="statsClose" class="btn outline">关闭</button>
      </div>
    </div>
  </div>

  <!-- 确认对话框 -->
  <div id="confirmModal" class="modal">
    <div class="modal-content card">
      <h3 id="confirmModalTitle">确认操作</h3>
      <p id="confirmModalMessage">您确定要执行此操作吗？此操作无法撤销。</p>
      <div class="modal-actions">
        <button id="confirmCancel" class="btn outline">取消</button>
        <button id="confirmAction" class="btn danger">确认</button>
      </div>
    </div>
  </div>

  <!-- 消息提示容器 -->
  <div class="toast-container" id="toastContainer" aria-live="polite"></div>

  <!-- JavaScript -->
  <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
  <script type="module" src="js/app.js"></script>
</body>

</html>